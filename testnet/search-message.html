<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>myMessage - light-grade & encrypted data storage</title>
	<link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png">
	<link rel="stylesheet" href="css/jquery-ui.min.css">
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/main.css">
	<script src="./js/jquery-3.3.1.min.js"></script>
	<script>window.jQuery || document.write('<script src="js/jquery-3.3.1.min.js" defer><\/script>')</script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous" defer></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous" defer></script>
	<script src="js/jq.ui.datepicker.js" defer></script>
	<script src="js/jquery.main.js" defer></script>
</head>
<body>
	<div id="wrapper">
		<div class="wrapper-holder">
			<header class="header">
				<div class="container">
					<div class="header-holder">
						<strong class="logo">
							<a href="/"><img src="images/logo.svg" alt="My Message"></a>
						</strong>
						<nav class="navbar navbar-expand-lg navbar-light">
							<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation-collapse" aria-controls="navigation-collapse" aria-expanded="false" aria-label="Toggle navigation">
								<span class="navbar-toggler-icon"></span>
							</button>
							<div class="collapse navbar-collapse" id="navigation-collapse">
								<div class="nav-area">
									<ul class="navbar-nav">
										<li class="nav-item">
											<a class="nav-link" href="/">Home</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="/testnet">Send Message</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="/testnet/read-message.html">Read Message</a>
										</li>
										<!-- <li class="nav-item">
											<a class="nav-link" href="#">Message Viewer</a>
										</li> -->
										<li class="nav-item active">
											<a class="nav-link" href="/testnet/search-message.html">Search</a>
										</li>
									</ul>
									<div class="header-select">
										<a href="#" class="select-opener">
											<span class="select-opener-text">
												<span class="select-image">
													<img src="images/zilliqa.svg" width="15" height="21" alt="zilliqa">
												</span>
												<span class="select-text">Zilliqa</span>
											</span>
										</a>
										<div class="header-select-dropdown">
											<ul class="select-dropdown-list list-unstyled">
												<li>
													<a href="#" class="select-dropdown-link">
														<span class="select-opener-text">
															<span class="select-image">
																<img src="images/binance.svg" width="20" height="20" alt="Binance">
															</span>
															<span class="select-text">Binance Smart Chain</span>
														</span>
													</a>
												</li>
												<li>
													<a href="#" class="select-dropdown-link">
														<span class="select-opener-text">
															<span class="select-image">
																<img src="images/avax.svg" width="20" height="20" alt="Avalanche">
															</span>
															<span class="select-text">Avalanche</span>
														</span>
													</a>
												</li>
												<li class="active">
													<a href="#" class="select-dropdown-link">
														<span class="select-opener-text">
															<span class="select-image">
																<img src="images/zilliqa.svg" width="15" height="21" alt="zilliqa">
															</span>
															<span class="select-text">Zilliqa</span>
														</span>
													</a>
												</li>
											</ul>
										</div>
									</div>
									<span class="btn-wrap">
										<a href="#" class="btn btn-outline-primary">
											<span class="btn-text">disconnect</span>
										</a>
									</span>
								</div>
							</div>
						</nav>
					</div>
				</div>
			</header>
			<main class="main">
				<div class="message-info-section">
					<div class="container">
						<div class="heading-area">
							<h1 class="h4">Search message</h1>
							<p>Search by using sender address, from and to date, and/or keywords. You can also search for messages that is encrypted </p>
						</div>
						<form action="#" class="search-message-section">
							<div class="form-group-area" data-datepicker='{"source": "./inc/datepicker-source.json", "rangepicker": true}'>
								<div class="form-group">
									<label class="label-field-text">Date From</label>
									<div class="date-field">
										<input type="text" class="form-control" id="datetimepickerfrom" placeholder="Any date" data-datepicker-from='{"minDate": 0}'>
										<span class="date-icon"><i class="icon-calender"></i></span>
									</div>
								</div>
								<div class="form-group">
									<label class="label-field-text">Date To</label>
									<div class="date-field">
										<input type="text" class="form-control" id="datetimepickerto"  placeholder="Any date" data-datepicker-to="">
										<span class="date-icon"><i class="icon-calender"></i></span>
									</div>
								</div>
							</div>
							<div class="form-group-area">
								<div class="form-group">
									<label class="label-field-text">Address (TXID)</label>
									<input type="text" class="form-control" id="searchaddress"  placeholder="Search by address (TXID)">
								</div>
								<div class="form-group">
									<label class="label-field-text">Keyword</label>
									<input type="text" class="form-control" id="searchstring"  placeholder="Search by Keywords/Tag/Content">
								</div>
							</div>
							<div class="form-group-area">
								<div class="form-group">
									<ul class="checkbox-list list-unstyled">
										<li>
											<div class="checkbox-area">
												<label class="checkbox-label">
													<input type="checkbox" id="encryptedmessage" >
													<span class="checkbox-text"><i class="icon"></i>Encrypted  Message Only</span>
												</label>
											</div>
										</li>
										<li>
											<div class="checkbox-area">
												<label class="checkbox-label">
													<input type="checkbox" id="attachment" >
													<span class="checkbox-text"><i class="icon"></i>With Attachment Only</span>
												</label>
											</div>
										</li>
									</ul>
								</div>
							</div>
							<div class="form-group-area">
								<div class="form-group" id="sendclassid">
									<a href="#" class="btn btn-primary">Search</a>
								</div>
							</div>
						</form>
						<div class="message-table-area">
							<hr>
								<p id="wait"></p>
								<table id="myDynamicTable" class="display" style="width:100%"></table>
							<hr>
						</div>
					</div>
				</div>
			</main>
		</div>
	</div>
	<script>
		async function searchmessage() {
			datefrom = document.getElementById("datetimepickerfrom").value;
			dateto = document.getElementById("datetimepickerto").value;
			var encrytpedcheckbox = document.getElementById("encryptedmessage").checked;
			var attachmentcheckbox = document.getElementById("attachment").checked;
			console.log("encrytpedcheckbox=", encrytpedcheckbox);
			console.log("attachmentcheckbox=", attachmentcheckbox);
			console.log("datefrom=", datefrom);
			console.log("dateto=", dateto);
			if (encrytpedcheckbox) f2 = "&eb=1";
			else f2 = "&eb=0";
			
			if (attachmentcheckbox) f3 = "&ab=1";
			else f3 = "&ab=0";
			
			f1 = "&df=" + datefrom + "&dt=" + dateto;
			searchaddress = document.getElementById("searchaddress").value;
			searchstring = document.getElementById("searchstring").value;
			urlstr = "getsearchmessage.php?s=" + searchstring + "&a=" + searchaddress + f1 + f2 + f3;
			console.log(urlstr);
			$.ajax({
				url: urlstr,
				success: function (result) {
					document.getElementById("myDynamicTable").innerHTML = result;
					$('#myDynamicTable').DataTable({
						"lengthMenu": [[25, 50, 100, 250, 500, -1], [25, 50, 100, 250, 500, "All"]],
						"scrollX": true, "bDestroy": true
					});
					document.getElementById("wait").innerHTML = "";
				}
			});
		}
		$("#sendclassid").on("mousedown", function () {
			document.getElementById("wait").innerHTML = '<i class="fas fa-spinner fa-spin fa-5x"></i>';
		}).on('mouseup', searchmessage);
		// $(document).ready(function () { $('#datepickerfrom').datepicker(); });
		// $(document).ready(function () { $('#datepickerto').datepicker(); });
	</script>
</body>
</html>
